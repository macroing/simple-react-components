"use client";
import{useRef as e,useState as a,useEffect as t}from"react";import l from"./Calendar.module.css.js";import{jsxs as n,jsx as d}from"react/jsx-runtime";const r={en:["January","February","March","April","May","June","July","August","September","October","November","December"],sv:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"]};function s(s){const i=s.bookings||{},c=s.country||"US",o=s.endDate,u=s.isCentered,h=s.language||"en",g=s.setEndDate,m=s.setStartDate,v=s.startDate,N=s.styles||l,f=e(null),b=e(null),[D,y]=a(new Date),[p,_]=a(null),[M,F]=a([]),[k,w]=a(0),[Y,S]=a(null),[C,x]=a(!1),[j,$]=a((new Date).getMonth()),[I,J]=a((new Date).getFullYear());function T(e,a){if(!v)return!1;const t=new Date(e.date.getFullYear(),e.date.getMonth(),e.date.getDate(),a,59,59,999);for(const[e,a]of Object.entries(i)){const l=e.split("-"),n=Number.parseInt(l[0]),d=Number.parseInt(l[1]),r=Number.parseInt(l[2]);for(let e=0;e<24;e++)if(void 0!==a[e]){const a=new Date(n,d-1,r,e,59,59);if(a>=v&&a<=t)return!1}}return!0}function A(e,a=null){const t=e.date.getFullYear(),l=(e.date.getMonth()+1<10?"0":"")+(e.date.getMonth()+1),n=(e.date.getDate()<10?"0":"")+e.date.getDate(),d=i[t+"-"+l+"-"+n];return d&&(null!==a&&!0===d[a]||null===a&&d.isBooked)}function O(e){const a=e.date.getFullYear(),t=(e.date.getMonth()+1<10?"0":"")+(e.date.getMonth()+1),l=(e.date.getDate()<10?"0":"")+e.date.getDate(),n=i[a+"-"+t+"-"+l];return n&&n.isFullyBooked}function L(e){m(new Date(p.date.getFullYear(),p.date.getMonth(),p.date.getDate(),Y,0,0,0)),g(null),S(null)}function V(e){g(new Date(p.date.getFullYear(),p.date.getMonth(),p.date.getDate(),Y,59,59,999)),S(null)}function B(e){x(!C)}return t((()=>(b.current=setInterval((()=>{y(new Date)}),1e3),()=>{clearInterval(b.current)})),[]),t((()=>{C&&f.current&&w(f.current.offsetHeight/2)}),[o,C,u,p,v]),t((()=>{!function(){const e=[],a=new Date(I,j+1,0).getDate();for(let t=0;t<a;t++){const a=new Date(I,j,t+1),l=a.toISOString(),n=t+1;e.push({date:a,key:l,number:n})}const t=e[0].date.getDay();if(0===t)for(let a=0;a<6;a++)e.unshift({date:null,key:"previous-"+a,number:""});else if(t>1)for(let a=t-1;a>0;a--)e.unshift({date:null,key:"previous-"+a,number:""});const l=e.length;if(l%7!=0)for(let a=0;a<7-l%7;a++)e.push({date:null,key:"next-"+a,number:""});F(e)}()}),[j]),n("div",{className:N.calendar_container,children:[d("button",{className:N.button,onClick:B,children:C?"sv"===h?"Dölj Kalender":"Hide Calendar":"sv"===h?"Visa Kalender":"Show Calendar"}),C&&n("div",{className:N.calendar,ref:f,style:u?{position:"fixed",right:"calc(50% - 150px)",top:`calc(50% - ${k}px)`}:{position:"absolute",right:"-75px",top:"100%"},children:[n("div",{className:N.bar,children:[n("div",{className:N.month_and_year,children:[d("button",{className:N.previous,onClick:function(e){$(j<=0?11:j-1),J(j<=0?I-1:I)},children:d("span",{className:"fa fa-chevron-left"})}),d("span",{className:N.month,children:"sv"===h?r.sv[j]:r.en[j]}),d("span",{className:N.year,children:I}),d("button",{className:N.next,onClick:function(e){$(j>=11?0:j+1),J(j>=11?I+1:I)},children:d("span",{className:"fa fa-chevron-right"})})]}),d("div",{className:N.separator}),d("div",{className:N.close_container,children:d("button",{className:N.close,onClick:B,children:d("span",{className:"fa fa-close"})})})]}),n("div",{className:N.day_container,children:[d("div",{className:N.day+" "+N.day_label,children:"sv"===h?"Mån":"Mon"}),d("div",{className:N.day+" "+N.day_label,children:"sv"===h?"Tis":"Tue"}),d("div",{className:N.day+" "+N.day_label,children:"sv"===h?"Ons":"Wed"}),d("div",{className:N.day+" "+N.day_label,children:"sv"===h?"Tor":"Thu"}),d("div",{className:N.day+" "+N.day_label,children:"sv"===h?"Fre":"Fri"}),d("div",{className:N.day+" "+N.day_label,children:"sv"===h?"Lör":"Sat"}),d("div",{className:N.day+" "+N.day_label+" "+N.day_label_sunday,children:"sv"===h?"Sön":"Sun"}),M.map((e=>n("div",{className:N.day+(null!==e.date&&e.date.getFullYear()===D.getFullYear()&&e.date.getMonth()===D.getMonth()&&e.date.getDate()===D.getDate()?" "+N.day_current:"")+(null!==e.date&&p&&e.date.getFullYear()===p.date.getFullYear()&&e.date.getMonth()===p.date.getMonth()&&e.date.getDate()===p.date.getDate()?" "+N.day_selected:"")+(null===e.date?" "+N.day_unavailable:""),onClick:null!==e.date?a=>{return t=e,void(p&&t&&p.date&&t.date&&p.date.getFullYear()===t.date.getFullYear()&&p.date.getMonth()===t.date.getMonth()&&p.date.getDate()===t.date.getDate()?_(null):_(t));var t}:void 0,children:[e.number,n("div",{className:N.day_tags,children:[null!==e.date&&A(e)&&!O(e)&&d("div",{className:N.booked}),null!==e.date&&O(e)&&d("div",{className:N.fully_booked}),null!==e.date&&v&&o&&e.date>=new Date(v.getFullYear(),v.getMonth(),v.getDate())&&e.date<=o&&d("div",{className:N.in_range})]})]},e.key)))]}),p&&n("div",{className:N.day,children:[d("div",{className:N.date,children:p.date.toLocaleDateString(`${h}-${c}`)}),d("div",{className:N.hours,children:new Array(24).fill(null).map(((e,a)=>n("div",{className:N.hour+(A(p,a)?" "+N.hour_booked:"")+(v&&o&&new Date(p.date.getFullYear(),p.date.getMonth(),p.date.getDate(),a)>=v&&new Date(p.date.getFullYear(),p.date.getMonth(),p.date.getDate(),a)<=o?" "+N.hour_in_range:"")+(Y===a?" "+N.hour_selected:""),onClick:e=>S(Y===a?null:a),children:[a<10?"0":"",a,Y===a&&d("div",{className:N.popup,onClick:e=>e.stopPropagation(),children:n("ul",{children:[d("li",{children:d("button",{disabled:A(p,a)||new Date(I,j,p.date.getDate(),Y)<new Date,onClick:L,children:"sv"===h?"Välj från":"Select from"})}),d("li",{children:d("button",{disabled:null===v||new Date(p.date.getFullYear(),p.date.getMonth(),p.date.getDate(),Y,59,59,999)<=v||A(p,a)||!T(p,a),onClick:V,children:"sv"===h?"Välj till":"Select to"})})]})})]},"hour-"+a)))})]}),(v||o)&&n("div",{className:N.date_range,children:[v&&n("div",{className:N.from,children:[d("div",{className:N.text,children:"sv"===h?"Från:":"From:"}),d("div",{className:N.date,children:v.toLocaleString(`${h}-${c}`)})]}),o&&n("div",{className:N.to,children:[d("div",{className:N.text,children:"sv"===h?"Till:":"To:"}),d("div",{className:N.date,children:o.toLocaleString(`${h}-${c}`)})]}),d("button",{className:N.reset,onClick:function(e){m(null),g(null),S(null)},children:"sv"===h?"Nollställ":"Reset"})]})]})]})}export{s as default};
